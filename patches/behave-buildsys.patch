From 74318f76abe60c0382be76a9dadc332c9ba2b1f6 Mon Sep 17 00:00:00 2001
From: Vadim Rutkovsky <vrutkovs@redhat.com>
Date: Fri, 11 Apr 2014 11:36:52 +0200
Subject: [PATCH] build-sys: Add configure script and Makefile to implement
 GNOME Build API

See http://people.gnome.org/~walters/docs/build-api.txt
---
 .travis.yml              |  2 +-
 Makefile                 |  7 +++++++
 behave/configuration.py  |  2 +-
 behave/formatter/html.py |  4 ++--
 behave/matchers.py       |  1 -
 configure                |  5 +++++
 setup.py                 | 12 ++++--------
 7 files changed, 20 insertions(+), 13 deletions(-)
 create mode 100644 Makefile
 create mode 100755 configure

diff --git a/.travis.yml b/.travis.yml
index b91e7c5..b874d85 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -5,7 +5,7 @@ python:
   - pypy
 
 install:
-  - pip install --use-mirrors -q mock nose PyHamcrest lxml
+  - pip install --use-mirrors -q mock nose PyHamcrest
   - python setup.py -q install
 script:
   - python --version
diff --git a/Makefile b/Makefile
new file mode 100644
index 0000000..b3f4452
--- /dev/null
+++ b/Makefile
@@ -0,0 +1,7 @@
+# behave *development* Makefile
+all:
+	python setup.py build
+
+install:
+	python setup.py install --root=$(DESTDIR)
+
diff --git a/behave/configuration.py b/behave/configuration.py
index 77bc43f..5ff85a9 100644
--- a/behave/configuration.py
+++ b/behave/configuration.py
@@ -6,7 +6,7 @@ import sys
 import argparse
 import logging
 import shlex
-from six.moves import configparser
+import ConfigParser as configparser
 
 from behave.model import FileLocation, ScenarioOutline
 from behave.reporter.junit import JUnitReporter
diff --git a/behave/formatter/html.py b/behave/formatter/html.py
index 7f125da..1c5a447 100644
--- a/behave/formatter/html.py
+++ b/behave/formatter/html.py
@@ -1,5 +1,5 @@
 from behave.formatter.base import Formatter
-import lxml.etree as ET
+import xml.etree.ElementTree as ET
 import base64
 import os.path
 from behave.compat.collections import Counter
@@ -385,4 +385,4 @@ class HTMLFormatter(Formatter):
 
         # Sending the report to stream
         if len(self.all_features) > 0:
-            self.stream.write(ET.tostring(self.html, pretty_print = True))
+            self.stream.write(ET.tostring(self.html))
diff --git a/behave/matchers.py b/behave/matchers.py
index eedf844..2573eff 100644
--- a/behave/matchers.py
+++ b/behave/matchers.py
@@ -2,7 +2,6 @@ from __future__ import with_statement
 
 import re
 import parse
-from parse_type import cfparse
 from behave import model
 
 
diff --git a/configure b/configure
new file mode 100755
index 0000000..d28a27a
--- /dev/null
+++ b/configure
@@ -0,0 +1,5 @@
+#!/bin/bash
+# http://people.gnome.org/~walters/docs/build-api.txt
+#buildapi-variable-no-builddir
+exec python setup.py build
+
diff --git a/setup.py b/setup.py
index aca25e3..9aedce6 100644
--- a/setup.py
+++ b/setup.py
@@ -16,14 +16,13 @@ os.chdir(HERE0)
 HERE = os.curdir
 sys.path.insert(0, HERE)
 
-from setuptools import find_packages, setup
-from setuptools_behave import behave_test
+from distutils.core import setup
 
 # -----------------------------------------------------------------------------
 # CONFIGURATION:
 # -----------------------------------------------------------------------------
 python_version = float("%s.%s" % sys.version_info[:2])
-requirements = ["parse>=1.6.3", "parse_type>=0.3.4", "six"]
+requirements = ['parse']
 if python_version < 2.7 or 3.0 <= python_version <= 3.1:
     requirements.append("argparse")
 if python_version < 2.7:
@@ -63,7 +62,7 @@ setup(
     author_email="behave-users@googlegroups.com",
     url="http://github.com/behave/behave",
     provides = ["behave", "setuptools_behave"],
-    packages = find_packages_by_root_package(BEHAVE),
+    packages=['behave', 'behave.formatter', 'behave.reporter', 'behave.compat'],
     py_modules = ["setuptools_behave"],
     entry_points={
         "console_scripts": [
@@ -76,10 +75,8 @@ setup(
     install_requires=requirements,
     test_suite="nose.collector",
     tests_require=["nose>=1.3", "mock>=1.0", "PyHamcrest>=1.8"],
-    cmdclass = {
-        "behave_test": behave_test,
-    },
     use_2to3= bool(python_version >= 3.0),
+    scripts=['bin/behave'],
     license="BSD",
     classifiers=[
         "Development Status :: 4 - Beta",
@@ -95,7 +92,6 @@ setup(
         "Topic :: Software Development :: Testing",
         "License :: OSI Approved :: BSD License",
     ],
-    zip_safe = True,
 )
 
 
-- 
1.9.0

